## Files used in Ogane et al.

This repository contains scripts and Jupyter notebooks used in "Development of Hidden Markov Modeling Method of Molecular Orientations and Structures from High-Speed Atomic Force Microscopy Time-Series Images" by Tomonori Ogane, Daisuke Noshiro, Toshio Ando, Atsuko Yamashita, Yuji Sugita, and Yasuhiro Matsunaga.

## Descriptions on files

The files are organized as follows:

- [src/afm.jl](https://github.com/matsunagalab/paper_ogane2022/blob/main/src/afm.jl)

  - Define function for hidden Makrov modeling (including the Viterbi and the Baum-Welch algorithms)
 
- [md/](https://github.com/matsunagalab/paper_ogane2022/tree/main/md)

  - Contains input files for the molecular dynamics simulations of a coarse-grained model for taste receptor
 
- [data/quaternion](https://github.com/matsunagalab/paper_ogane2022/tree/main/data/quaternion)

  - Quaternions for uniform rotations in the SO(3) group
 
- [data/t1r](https://github.com/matsunagalab/paper_ogane2022/tree/main/data/t1r)

  - Contain cluster structures (Markov state model structures) obtained by the clustering of MD trajectories
 
- [00_setup/](https://github.com/matsunagalab/paper_ogane2022/tree/main/00_setup)

  - Contain a script to generate pseudo-AFM images for likelihood calculations
 
- [paper_ogane2022/01_psudo_test/01_generate_realization01.jl](https://github.com/matsunagalab/paper_ogane2022/blob/main/01_psudo_test/01_generate_realization01.jl)

  - Script to generate pseudo-AFM images for twin experiment
 
- [01_psudo_test/02_analyze_realization01.jl](https://github.com/matsunagalab/paper_ogane2022/blob/main/01_psudo_test/02_analyze_realization01.jl)

  - Calculate frame-by-frame likelihood for the pseudo AFM images generated by [paper_ogane2022/01_psudo_test/01_generate_realization01.jl](https://github.com/matsunagalab/paper_ogane2022/blob/main/01_psudo_test/01_generate_realization01.jl)
 
- [01_psudo_test/03_0_calc_rmsd_freq_origin.jl](https://github.com/matsunagalab/paper_ogane2022/blob/main/01_psudo_test/03_0_calc_rmsd_freq_origin.jl)

  - Frame-by-frame rigid-body fitting analysis
 
- [01_psudo_test/03_1_calc_rmsd_freq_MD.jl](https://github.com/matsunagalab/paper_ogane2022/blob/main/01_psudo_test/03_2_calc_rmsd_freq_baumwelch.jl)

  - Apply the Viterbi algorithm with the transition probabilities of the ground-truth
 
- [01_psudo_test/03_2_calc_rmsd_freq_baumwelch.jl](https://github.com/matsunagalab/paper_ogane2022/blob/main/01_psudo_test/03_2_calc_rmsd_freq_baumwelch.jl)

  - Apply the Baum-Welch algorithm to estimate the transition probabilities and then apply the Viterbi algorithm

- [01_psudo_test/03_3_calc_rmsd_freq_rand.jl](https://github.com/matsunagalab/paper_ogane2022/blob/main/01_psudo_test/03_3_calc_rmsd_freq_rand.jl)

  - Apply the Viterbi algorithm with a transition probabilities created by a random matrix

 
## Large files on OneDrive

Pseudo-AFM images for twin experiments generated by [01_psudo_test/02_analyze_realization01.jl](https://github.com/matsunagalab/paper_ogane2022/blob/main/01_psudo_test/02_analyze_realization01.jl) are uploaded on a shared folder of OneDrive. They can be download from this link. 

## License

This repository is licensed under the under the terms of GNU General Public License v3.0. 

Quaternion data contained in `data/quaternion/` directory were taken from the repository of the BioEM program written by Cossio et al. https://github.com/bio-phys/BioEM. These are separately licensed under the terms of the GNU General Public License. Please check the license file `quaternion/LICENSE`. 


## Contact

Yasuhiro Matsunaga

ymatsunaga@mail.saitama-u.ac.jp

